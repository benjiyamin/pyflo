
import unittest

from pyflo import system


class TupleFromCsvTest(unittest.TestCase):

    def test_runoff_csv(self):
        data = system.tuple_list_from_csv('./resources/distributions/runoff/scs256.csv')
        control = [
            (0.000, 0.000),
            (0.200, 0.150),
            (0.400, 0.320),
            (0.600, 0.600),
            (0.800, 0.930),
            (1.000, 1.000),
            (1.200, 0.960),
            (1.400, 0.880),
            (1.600, 0.780),
            (1.800, 0.690),
            (2.000, 0.590),
            (2.200, 0.520),
            (2.400, 0.480),
            (2.600, 0.430),
            (2.800, 0.390),
            (3.000, 0.350),
            (3.200, 0.320),
            (3.400, 0.290),
            (3.600, 0.260),
            (3.800, 0.230),
            (4.000, 0.210),
            (4.200, 0.200),
            (4.400, 0.190),
            (4.600, 0.180),
            (4.800, 0.170),
            (5.000, 0.160),
            (5.200, 0.150),
            (5.400, 0.140),
            (5.600, 0.130),
            (5.800, 0.120),
            (6.000, 0.110),
            (6.200, 0.100),
            (6.400, 0.090),
            (6.600, 0.080),
            (6.800, 0.070),
            (7.000, 0.060),
            (7.200, 0.050),
            (7.400, 0.045),
            (7.600, 0.040),
            (7.800, 0.035),
            (8.000, 0.030),
            (8.200, 0.025),
            (8.400, 0.020),
            (8.600, 0.015),
            (8.800, 0.010),
            (9.000, 0.000)
        ]
        self.assertListEqual(data, control)

    def test_rainfall_csv(self):
        data = system.tuple_list_from_csv('./resources/distributions/rainfall/nrcsiii.csv')
        control = [
            (0.000, 0.000),
            (0.010, 0.002),
            (0.021, 0.005),
            (0.031, 0.007),
            (0.042, 0.010),
            (0.052, 0.012),
            (0.063, 0.015),
            (0.073, 0.017),
            (0.083, 0.020),
            (0.094, 0.023),
            (0.104, 0.026),
            (0.115, 0.028),
            (0.125, 0.031),
            (0.135, 0.034),
            (0.146, 0.037),
            (0.156, 0.040),
            (0.167, 0.043),
            (0.177, 0.047),
            (0.188, 0.050),
            (0.198, 0.053),
            (0.208, 0.057),
            (0.219, 0.060),
            (0.229, 0.064),
            (0.240, 0.068),
            (0.250, 0.072),
            (0.260, 0.076),
            (0.271, 0.080),
            (0.281, 0.085),
            (0.292, 0.089),
            (0.302, 0.094),
            (0.313, 0.100),
            (0.323, 0.107),
            (0.333, 0.115),
            (0.344, 0.122),
            (0.354, 0.130),
            (0.365, 0.139),
            (0.375, 0.148),
            (0.385, 0.157),
            (0.396, 0.167),
            (0.406, 0.178),
            (0.417, 0.189),
            (0.427, 0.202),
            (0.438, 0.216),
            (0.448, 0.232),
            (0.458, 0.250),
            (0.469, 0.271),
            (0.479, 0.298),
            (0.490, 0.339),
            (0.500, 0.500),
            (0.510, 0.662),
            (0.521, 0.702),
            (0.531, 0.729),
            (0.542, 0.751),
            (0.552, 0.769),
            (0.563, 0.785),
            (0.573, 0.799),
            (0.583, 0.811),
            (0.594, 0.823),
            (0.604, 0.834),
            (0.615, 0.844),
            (0.625, 0.853),
            (0.635, 0.862),
            (0.646, 0.870),
            (0.656, 0.878),
            (0.667, 0.886),
            (0.677, 0.893),
            (0.688, 0.900),
            (0.698, 0.907),
            (0.708, 0.911),
            (0.719, 0.916),
            (0.729, 0.920),
            (0.740, 0.925),
            (0.750, 0.929),
            (0.760, 0.933),
            (0.771, 0.936),
            (0.781, 0.940),
            (0.792, 0.944),
            (0.802, 0.947),
            (0.813, 0.951),
            (0.823, 0.954),
            (0.833, 0.957),
            (0.844, 0.960),
            (0.854, 0.963),
            (0.865, 0.966),
            (0.875, 0.969),
            (0.885, 0.972),
            (0.896, 0.975),
            (0.906, 0.978),
            (0.917, 0.981),
            (0.927, 0.983),
            (0.938, 0.986),
            (0.948, 0.988),
            (0.958, 0.991),
            (0.969, 0.993),
            (0.979, 0.996),
            (0.990, 0.998),
            (1.000, 1.000)
        ]
        self.assertListEqual(data, control)
